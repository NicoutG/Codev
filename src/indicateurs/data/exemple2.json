{
  "sujet": {
    "tables": ["etudiant", "diplome"],
    "conditions": {}
  },
  "colonnes": [
    {
      "type": "group_by",
      "titre": "Sexe",
      "expr": { "col": "sexe" }
    },
    {
      "type": "case",
      "titre": "Tranche d'âge",
      "cases": [
        { "label": "<18", "when": { "<": [ { "col": "age" }, 18 ] } },
        { "label": "18-25", "when": { "and": [ { ">=": [ { "col": "age" }, 18 ] }, { "<=": [ { "col": "age" }, 25 ] } ] } },
        { "label": ">25", "when": { ">": [ { "col": "age" }, 25 ] } }
      ]
    },
    {
      "type": "aggregation",
      "titre": "Pourcentage diplômés",
      "expr": {
        "op": "*",
        "args": [
          100,
          {
            "op": "/",
            "args": [
              {
                "agg": "count",
                "condition": { "=": [ { "col": "obtenu" }, true ] }
              },
              {
                "agg": "count",
                "subject": {
                  "tables": ["diplome"],
                  "conditions": { "=": [ { "col": "obtenu" }, true ] }
                }
              }
            ]
          }
        ]
      }
    }
  ]
}
